---
phase: 01-content-foundation-navigation
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/app/layout.tsx
  - src/app/modules/[moduleId]/[lessonId]/page.tsx
  - src/components/navigation/CourseSidebar.tsx
  - src/components/navigation/LessonBreadcrumbs.tsx
  - src/components/navigation/LessonNavButtons.tsx
  - src/components/navigation/MobileNav.tsx
  - src/app/globals.css
autonomous: false

must_haves:
  truths:
    - "User can browse all modules and lessons via a persistent sidebar table of contents"
    - "User can see breadcrumbs showing their current position (Home > Module > Lesson)"
    - "User can navigate between lessons with Previous/Next buttons"
    - "User can access any lesson non-linearly by clicking in sidebar"
    - "Sidebar collapses to hamburger menu on mobile (< 768px viewport)"
    - "Code blocks scroll horizontally without breaking page layout on mobile"
    - "All navigation elements are usable on phone, tablet, and desktop"
  artifacts:
    - path: "src/components/navigation/CourseSidebar.tsx"
      provides: "Sidebar table of contents with all modules and lessons, active state highlighting"
    - path: "src/components/navigation/LessonBreadcrumbs.tsx"
      provides: "Breadcrumb trail: Home > Module Name > Lesson Name"
    - path: "src/components/navigation/LessonNavButtons.tsx"
      provides: "Previous/Next navigation buttons at bottom of lesson content"
    - path: "src/components/navigation/MobileNav.tsx"
      provides: "Mobile hamburger menu trigger for sidebar sheet"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/navigation/CourseSidebar.tsx"
      via: "SidebarProvider wrapping CourseSidebar + SidebarInset"
      pattern: "SidebarProvider.*CourseSidebar"
    - from: "src/components/navigation/CourseSidebar.tsx"
      to: "content/meta.json"
      via: "reads course structure for sidebar menu items"
      pattern: "getCourseStructure|meta\\.json"
    - from: "src/app/modules/[moduleId]/[lessonId]/page.tsx"
      to: "src/components/navigation/LessonBreadcrumbs.tsx"
      via: "renders breadcrumbs with moduleId and lessonId props"
      pattern: "LessonBreadcrumbs.*moduleId"
    - from: "src/app/modules/[moduleId]/[lessonId]/page.tsx"
      to: "src/components/navigation/LessonNavButtons.tsx"
      via: "renders prev/next buttons with lesson.previous and lesson.next"
      pattern: "LessonNavButtons.*previous.*next"
---

<objective>
Add complete navigation system (sidebar, breadcrumbs, previous/next buttons) and ensure mobile responsiveness across all pages.

Purpose: Transforms the content-viewable app into a fully navigable learning platform. After this plan, users can browse the course structure, see where they are, and move between lessons -- on any device.

Output: Sidebar table of contents, breadcrumb navigation, previous/next lesson buttons, mobile-responsive layout with collapsible sidebar.
</objective>

<execution_context>
@/Users/dominicjoseph/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dominicjoseph/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-content-foundation-navigation/01-RESEARCH.md
@.planning/phases/01-content-foundation-navigation/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build sidebar, breadcrumbs, prev/next navigation, and responsive layout</name>
  <files>
    src/components/navigation/CourseSidebar.tsx
    src/components/navigation/LessonBreadcrumbs.tsx
    src/components/navigation/LessonNavButtons.tsx
    src/components/navigation/MobileNav.tsx
    src/app/layout.tsx
    src/app/modules/[moduleId]/[lessonId]/page.tsx
    src/app/globals.css
  </files>
  <action>
1. Create `src/components/navigation/CourseSidebar.tsx`:
   - 'use client' component (needs usePathname for active state)
   - Use shadcn/ui Sidebar, SidebarContent, SidebarGroup, SidebarGroupLabel, SidebarGroupContent, SidebarMenu, SidebarMenuItem, SidebarMenuButton components
   - Accept `structure: CourseStructure` as a prop (passed from server layout to avoid client-side data fetching)
   - Render each module as a SidebarGroup with module title as SidebarGroupLabel
   - Render each lesson as a SidebarMenuItem with SidebarMenuButton wrapping a Next.js Link
   - Highlight active lesson using `usePathname()` comparison with `isActive` prop on SidebarMenuButton
   - Show module lesson count in a muted badge next to module title
   - At the top of sidebar, display "FMAI Claude Code Academy" as a clickable header linking to /

2. Create `src/components/navigation/LessonBreadcrumbs.tsx`:
   - Server Component (no client-side state needed -- moduleId and lessonId passed as props)
   - Use shadcn/ui Breadcrumb, BreadcrumbList, BreadcrumbItem, BreadcrumbLink, BreadcrumbPage, BreadcrumbSeparator
   - Accept props: `moduleTitle: string`, `lessonTitle: string`, `moduleId: string`
   - Render: Home (link to /) > {moduleTitle} (link to /modules/{moduleId}) > {lessonTitle} (current page, no link)
   - Style with margin-bottom for spacing from content

3. Create `src/components/navigation/LessonNavButtons.tsx`:
   - Server Component
   - Accept props: `previous: LessonNavLink | null`, `next: LessonNavLink | null`
   - Use shadcn/ui Button with variant="outline"
   - Left-aligned Previous button with ChevronLeft icon and lesson title
   - Right-aligned Next button with ChevronRight icon and lesson title
   - Hide button if null (first lesson has no previous, last has no next)
   - Container: flex justify-between, with top border and padding-top for visual separation from content
   - Links use Next.js Link component pointing to getLessonPath(moduleId, lessonId)

4. Create `src/components/navigation/MobileNav.tsx`:
   - 'use client' component
   - Import SidebarTrigger from shadcn/ui sidebar (this is the hamburger button)
   - Render SidebarTrigger with a Menu icon from lucide-react
   - This component is placed in the header/top bar area and only visible on mobile
   - The shadcn/ui SidebarProvider automatically handles the sheet behavior on mobile viewports

5. Update `src/app/layout.tsx`:
   - Import SidebarProvider and SidebarInset from shadcn/ui
   - Import CourseSidebar and MobileNav
   - Load course structure server-side using getCourseStructure() and pass to CourseSidebar as prop
   - Structure the layout as:
     SidebarProvider containing CourseSidebar and SidebarInset
     Inside SidebarInset: a sticky header with the mobile nav trigger, then a main content area with responsive padding (p-4 on mobile, p-6 on md, p-8 on lg) and max-w-4xl for comfortable reading width
   - On desktop, sidebar is always visible. On mobile (< 768px), sidebar becomes a sheet triggered by hamburger button.

6. Update `src/app/modules/[moduleId]/[lessonId]/page.tsx`:
   - Add LessonBreadcrumbs above the h1 title, passing moduleTitle, lessonTitle, moduleId
   - Add LessonNavButtons below the MarkdownRenderer, passing lesson.previous and lesson.next
   - Get module title from the course structure for breadcrumb display

7. Update `src/app/globals.css` for responsive content:
   - Add `pre { overflow-x: auto; }` for code block horizontal scrolling
   - Ensure prose container does not exceed viewport on mobile: `.prose { max-width: 100%; overflow-wrap: break-word; }`
   - Style the Obsidian callout HTML output from remark-obsidian-callout (if present in content) with appropriate colors and borders
   - Add smooth transitions for sidebar open/close

8. Run `npm run build` to verify everything compiles.

9. Run `npm run dev` and test:
   - Desktop (>1024px): Sidebar visible on left, content on right, breadcrumbs above content, prev/next below
   - Tablet (768px-1024px): Sidebar may collapse, content fills width
   - Mobile (<768px): Sidebar hidden, hamburger menu in top bar, sidebar slides in as sheet overlay when tapped
   - Navigate between lessons using prev/next buttons -- verify they link correctly
   - Click different lessons in sidebar -- verify active state highlights correctly
   - Verify code blocks scroll horizontally, not causing page-level horizontal scroll
  </action>
  <verify>
    Run `npm run build` -- must succeed.
    Run `npm run dev` and verify:
    1. http://localhost:3000 -- landing page renders with sidebar showing all modules
    2. Click into a lesson -- breadcrumbs show "Home > Module > Lesson"
    3. Scroll to bottom -- Previous/Next buttons visible with correct lesson names
    4. Click Next -- navigates to next lesson, active sidebar item updates
    5. Resize browser to mobile width -- sidebar collapses, hamburger appears
    6. Click hamburger -- sidebar slides in as overlay
    7. Code blocks on lesson pages scroll horizontally without page overflow
  </verify>
  <done>
    Sidebar shows all 7 modules with nested lessons and active state. Breadcrumbs display current position in hierarchy. Previous/Next buttons enable sequential navigation. Mobile responsive: sidebar becomes sheet menu, content fills viewport, code blocks scroll. All pages build statically.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual and functional verification of complete app</name>
  <files>none (verification only)</files>
  <action>
Human verifies the complete Phase 1 application: FMAI Claude Code Academy with all course content rendered from Obsidian markdown, full navigation (sidebar, breadcrumbs, prev/next), and mobile responsive layout. Start the dev server if not running: `npm run dev`.

Desktop verification (full browser window):
1. Visit http://localhost:3000 -- landing page should show 7 module cards in a grid
2. Click "Architecture Overview" module -- should show module overview with lesson list
3. Click into the lesson -- verify:
   a. Sidebar on left shows all modules with nested lessons
   b. Current lesson highlighted in sidebar
   c. Breadcrumbs above content: Home > Architecture Overview > Architecture Overview
   d. Content renders with code blocks (syntax highlighted), tables, and headings
   e. Wikilinks like "Local vs Remote Layers" are clickable and navigate correctly
   f. Version metadata visible at bottom of lesson
   g. Previous/Next buttons at bottom with correct lesson names
4. Click Next to navigate to Agents module -- verify sidebar active state updates
5. Navigate to a long lesson (e.g., GSD Pipeline Agents or Hook Reference) -- verify code blocks scroll horizontally

Mobile verification (resize browser to ~375px wide OR use Chrome DevTools device mode):
6. Sidebar should be hidden, hamburger icon visible in top bar
7. Tap hamburger -- sidebar slides in as overlay sheet
8. Tap a lesson in sidebar -- navigates to it, sidebar closes
9. Lesson content fills screen width, no horizontal page scroll
10. Code blocks scroll independently within their container
11. Previous/Next buttons stack vertically or are large enough to tap
12. Breadcrumbs are readable (may truncate long module/lesson names)

Content verification (spot check 3-4 lessons):
13. Agents > GSD Pipeline Agents -- large content file, many headings, code blocks, tables
14. Plugins > Plugin Reference -- wikilinks to Hook Reference and other lessons
15. Config > Settings and Orchestration -- tables and config examples
16. Hooks > Hook Reference -- longest file (1415 lines), verify it renders fully

All 8 Phase 1 success criteria from ROADMAP.md should be met.
  </action>
  <verify>User confirms all checks pass by typing "approved" or describes issues found.</verify>
  <done>All 8 Phase 1 success criteria verified by human: content rendering, navigation (sidebar, breadcrumbs, prev/next), non-linear access, syntax highlighting, wikilink resolution, and mobile responsiveness.</done>
</task>

</tasks>

<verification>
Phase 1 complete verification against ROADMAP success criteria:
1. User can view lesson content rendered from Obsidian markdown files with correct formatting -- CHECK lesson pages
2. User can navigate between lessons using Previous/Next buttons -- CHECK nav buttons
3. User can browse all modules via sidebar table of contents -- CHECK sidebar
4. User can see breadcrumbs showing current position in course hierarchy -- CHECK breadcrumbs
5. User can access any lesson non-linearly without forced ordering -- CHECK sidebar links
6. Code blocks display with syntax highlighting -- CHECK code rendering
7. Obsidian-specific syntax (wikilinks) renders correctly as web equivalents -- CHECK wikilink resolution
8. App is mobile responsive and works on phone, tablet, and desktop -- CHECK responsive layout
</verification>

<success_criteria>
1. Sidebar displays all 7 modules with nested lessons and highlights active lesson (NAV-02)
2. Breadcrumbs show Home > Module > Lesson on every lesson page (NAV-03)
3. Previous/Next buttons enable sequential lesson navigation (NAV-01)
4. Any lesson accessible by clicking in sidebar without forced ordering (NAV-04)
5. Mobile: sidebar collapses to sheet menu, content fills viewport (UI-01)
6. Code blocks scroll horizontally on all screen sizes without page overflow
7. Human verification confirms visual quality and navigation functionality
</success_criteria>

<output>
After completion, create `.planning/phases/01-content-foundation-navigation/01-03-SUMMARY.md`
</output>
